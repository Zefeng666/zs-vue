webpackJsonp([9],{"/0UN":function(e,t,a){"use strict";String,String,String,String,String,Number,Array,Object,Number,Boolean;var s={name:"checker",props:{defaultItemClass:String,selectedItemClass:String,disabledItemClass:String,type:{type:String,default:"radio"},value:[String,Number,Array,Object],max:Number,radioRequired:Boolean},watch:{value:function(e){this.currentValue=e},currentValue:function(e){this.$emit("input",e),this.$emit("on-change",e)}},data:function(){return{currentValue:this.value}}},r={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"vux-checker-box"},[this._t("default")],2)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("Luh7")},null,null);t.a=i.exports},Ahvm:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),r=a.n(s),i=a("1sNz"),n=a("ABCa"),u=a("odqc"),c=a("Znkm"),d=a("1DHf"),o=a("rHil"),l=a("pDNl"),h=a("7Ah8"),p=a("2sLL"),v=a("QTi7"),f=a("cHu4"),m=a("FHgB"),x=a.n(m),g=a("/0UN"),b=a("hGvq"),$=a("/kga"),y=(i.a,n.a,u.a,c.a,d.a,o.a,l.a,h.a,p.a,v.a,f.a,x.a,g.a,b.a,$.a,{name:"getGoods",components:{ViewBox:i.a,XHeader:n.a,Tab:u.a,TabItem:c.a,Cell:d.a,Group:o.a,XInput:l.a,PopupPicker:h.a,XButton:p.a,Box:v.a,XAddress:f.a,ChinaAddressV4Data:x.a,Checker:g.a,CheckerItem:b.a,XDialog:$.a},created:function(){this.queryOrder(),"{}"===r()(this.$route.params)?this.queryUserAddress():(this.getGoodsObj.addressId=this.$route.params.addressId,this.getGoodsObj.addressName=this.$route.params.addressName),this.queryUser()},computed:{payAmount:function(){return this.getGoodsObj.quantity*this.price}},data:function(){return{index:0,checkerWhich:1,price:1,userInfo:{},productInfo:{},getGoodsObj:{quantity:"",addressId:"",proxyProvice:"",proxyCity:"",proxyArea:"",addressName:"",addressValue:[]},orderList:[],addressData:x.a,isInpNum:!1,showToast:!1}},methods:{queryUser:function(){var e=this;this.$api.queryUser({}).then(function(t){200===t.code?(e.userInfo=t.data.user,e.queryProduct()):e.$vux.toast.text(t.message,"top")})},queryProduct:function(){var e=this;this.$api.queryProduct().then(function(t){if(200===t.code)switch(e.productInfo=t.data.product,e.userInfo.vipLevel){case 0:e.price=.7*e.productInfo.price;break;case 1:e.price=.65*e.productInfo.price;break;case 2:e.price=.6*e.productInfo.price;break;case 3:e.price=.55*e.productInfo.price;break;case 4:e.price=.5*e.productInfo.price;break;default:e.price=e.productInfo.price}else e.$vux.toast.text(t.message,"top")})},queryUserAddress:function(){var e=this;this.$api.queryUserAddress({}).then(function(t){200===t.code&&(t.data.address.length<1?e.getGoodsObj.addressName="无":(e.getGoodsObj.addressId=t.data.address[0].id,e.getGoodsObj.addressName=t.data.address[0].province+t.data.address[0].city+t.data.address[0].area+t.data.address[0].detail))})},queryOrder:function(){var e=this;this.$vux.loading.show({text:""}),this.$api.queryOrder({pageNo:1,pageSize:500}).then(function(t){200===t.code&&(e.orderList=t.data.items),e.$vux.loading.hide()})},cancelOrder:function(e){var t=this;this.$api.cancelOrder({id:e}).then(function(e){200===e.code&&(t.$vux.toast.text("取消订单成功","top"),t.queryOrder())})},insertOrder:function(e){var t=this,a={};if(!this.getGoodsObj.addressId)return this.$vux.toast.text("请添加地址后再拿货~","top");a.addressId=this.getGoodsObj.addressId,a.productId=this.productInfo.productId,a.quantity=this.getGoodsObj.quantity,a.isOffline=e,this.$api.insertOrder(a).then(function(a){200===a.code?(0===e?t.onBridgeReady(a.data.appId,a.data.nonceStr,a.data.package,a.data.paySign,a.data.timeStamp):(t.$vux.toast.text("添加线下支付订单成功~","top"),t.queryOrder(),t.index=1),t.showToast=!1):t.$vux.toast.text(a.message,"top")})},toSelectAddress:function(){this.$router.push({name:"selectAddress",params:{addressId:this.getGoodsObj.addressId,addressName:this.getGoodsObj.addressName}})},toSale:function(){this.$router.push({name:"sales"})},selectChecker:function(e){1===e&&this.queryOrder()},selectCheckerBtn:function(e){"1"==e?-1===this.userInfo.vipLevel&&(this.getGoodsObj.quantity=1,this.isInpNum=!0):this.isInpNum=!1},onBridgeReady:function(e,t,a,s,r){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e,timeStamp:r.toString(),nonceStr:t,package:a,signType:"MD5",paySign:s},function(e){"get_brand_wcpay_request:ok"==e.err_msg?(this.$vux.toast.text("支付成功","top"),this.queryOrder(),this.index=1):this.$vux.toast.text("支付失败","top")})},whichStatus:function(e){return 0==e.orderStatus?1==e.isOffline?"待公司确认":"未支付":1==e.orderStatus?"待发货":2==e.orderStatus?"已发货":void 0}}}),k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"getGoods"},[a("x-header",{staticClass:"vux-1px-b my-header",attrs:{"left-options":{backText:"",preventGoBack:!0},fixed:""},on:{"on-click-back":function(t){e.toSale()}}},[e._v("申请拿货")]),e._v(" "),a("tab",{staticClass:"my-tab",attrs:{"line-width":2,"active-color":"#2a93f5"},model:{value:e.index,callback:function(t){e.index=t},expression:"index"}},[a("tab-item",{staticClass:"vux-center vux-1px-t",attrs:{selected:""}},[e._v("申请拿货")]),e._v(" "),a("tab-item",{staticClass:"vux-center vux-1px-t",on:{"on-item-click":e.selectChecker}},[e._v("历史订单")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.index,expression:"index === 0"}],staticClass:"swiper-box"},[a("group",{attrs:{"label-width":"4.5em","label-margin-right":"2em","label-align":"right"}},[a("cell",{attrs:{title:"拿货地址","align-items":"flex-start",value:e.getGoodsObj.addressName,"value-align":"left","is-link":""},nativeOn:{click:function(t){e.toSelectAddress()}}}),e._v(" "),a("x-input",{attrs:{title:"申请数量",name:"username",placeholder:"请输入","show-clear":!1,disabled:e.isInpNum},model:{value:e.getGoodsObj.quantity,callback:function(t){e.$set(e.getGoodsObj,"quantity",t)},expression:"getGoodsObj.quantity"}},[a("checker",{staticClass:"checker-box",attrs:{slot:"right","radio-required":!0,"default-item-class":"checker-item","selected-item-class":"checker-item-selected"},on:{"on-change":e.selectCheckerBtn},slot:"right",model:{value:e.checkerWhich,callback:function(t){e.checkerWhich=t},expression:"checkerWhich"}},[a("checker-item",{staticClass:"checker-item-selected",attrs:{value:"1"}},[e._v("瓶")])],1)],1),e._v(" "),a("cell",{attrs:{title:"支付金额","align-items":"flex-start","value-align":"left"}},[e._v(e._s(e.payAmount.toFixed(2))+"元")])],1),e._v(" "),a("x-button",{staticClass:"submit-btn",attrs:{type:"primary"},nativeOn:{click:function(t){e.showToast=!0}}},[e._v("立即支付")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.index,expression:"index === 1"}],staticClass:"tab-swiper"},e._l(e.orderList,function(t,s){return a("div",{key:s,staticClass:"order-box vux-1px-b"},[a("p",[a("span",[e._v("申请数量："+e._s(t.order.quantity+"瓶"))]),e._v(" "),a("span",{staticClass:"text-right"},[e._v(e._s(e.whichStatus(t.order)))])]),e._v(" "),a("p",[a("span",[e._v("收货地址："+e._s(t.userAddress.province+t.userAddress.city+t.userAddress.area+t.userAddress.detail))])]),e._v(" "),a("p",[a("span",[e._v("创建时间："+e._s(e._f("formatDate")(t.order.createTime)))])])])})),e._v(" "),a("x-dialog",{staticClass:"dialog-demo",attrs:{"hide-on-blur":""},model:{value:e.showToast,callback:function(t){e.showToast=t},expression:"showToast"}},[a("div",{staticStyle:{padding:"15px"}},[a("x-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.insertOrder(0)}}},[e._v("微信支付")]),e._v(" "),a("x-button",{attrs:{type:"default"},nativeOn:{click:function(t){e.insertOrder(1)}}},[e._v("线下支付")])],1),e._v(" "),a("div",{on:{click:function(t){e.showToast=!1}}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("关闭")])])])],1)},staticRenderFns:[]};var _=a("VU/8")(y,k,!1,function(e){a("Q6uZ")},"data-v-32fc9a3e",null);t.default=_.exports},Luh7:function(e,t){},Q6uZ:function(e,t){},QTi7:function(e,t,a){"use strict";String;var s={name:"box",props:{gap:String}},r={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{style:{margin:this.gap}},[this._t("default")],2)},staticRenderFns:[]},i=a("VU/8")(s,r,!1,null,null,null);t.a=i.exports},dPZ0:function(e,t){},hGvq:function(e,t,a){"use strict";var s=a("mvHQ"),r=a.n(s),i=a("pFYg"),n=a.n(i);String,Number,Object,Boolean;var u={name:"checker-item",props:{value:{type:[String,Number,Object],required:!0},disabled:Boolean},watch:{disabled:function(e){e&&"radio"===this.$parent.type&&this.value===this.$parent.currentValue&&(this.$parent.currentValue="")}},computed:{classNames:function(){var e=this,t="string"==typeof this.value||"number"==typeof this.value,a={"vux-tap-active":!this.disabled};if(this.$parent.defaultItemClass&&(a[this.$parent.defaultItemClass]=!0),this.$parent.selectedItemClass){var s=!1;if("radio"===this.$parent.type)t&&this.$parent.currentValue===this.value?s=!0:"object"===n()(this.value)&&c(this.$parent.currentValue,this.value)&&(s=!0);else if("string"==typeof this.value)this.$parent.currentValue.indexOf(this.value)>-1&&(s=!0);else if(this.$parent.currentValue&&this.$parent.currentValue.length){s=this.$parent.currentValue.filter(function(t){return c(t,e.value)}).length>0}a[this.$parent.selectedItemClass]=s}return this.$parent.disabledItemClass&&(a[this.$parent.disabledItemClass]=this.disabled),a}},methods:{select:function(){"radio"===this.$parent.type?this.selectRadio():this.selectCheckbox()},selectRadio:function(){this.disabled||(this.$parent.currentValue===this.value?this.$parent.radioRequired||(this.$parent.currentValue=""):this.$parent.currentValue=this.value),this.$emit("on-item-click",this.value,this.disabled)},selectCheckbox:function(){this.$parent.currentValue&&null!==this.$parent.currentValue||(this.$parent.currentValue=[]);var e="string"==typeof this.value||"number"==typeof this.value;if(!this.disabled){var t=-1;(t=e?this.$parent.currentValue.indexOf(this.value):this.$parent.currentValue.map(function(e){return r()(e)}).indexOf(r()(this.value)))>-1?this.$parent.currentValue.splice(t,1):(!this.$parent.max||this.$parent.max&&null!==this.$parent.currentValue&&this.$parent.currentValue.length<this.$parent.max)&&(this.$parent.currentValue&&this.$parent.currentValue.length||(this.$parent.currentValue=[]),this.$parent.currentValue.push(this.value))}this.$emit("on-item-click",this.value,this.disabled)}}};function c(e,t){return r()(e)===r()(t)}var d={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"vux-checker-item",class:this.classNames,on:{click:this.select}},[this._t("default")],2)},staticRenderFns:[]};var o=a("VU/8")(u,d,!1,function(e){a("dPZ0")},null,null);t.a=o.exports}});
//# sourceMappingURL=9.de9895da01cf8f911b20.js.map